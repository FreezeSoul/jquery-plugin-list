!function(t,i,e,s){"use strict";function n(i,e){this.fixedSize=!1,this.oneColumn=!1,this.$list=null,this.colCount=null,this.rowCount=null,this.gutterStep=null,this.label=1,this.zIndex=1e3,this.tiles=null,this.element=i,this.settings=t.extend({},l,e),this._defaults=l,this._name=o,this.init()}var o="list",l={rowSize:40,colSize:60,gutter:7,threshold:"50%",mode:"mixed",startWidth:"100%",startSize:100,singleWidth:300,shadow1:"0 1px 3px  0 rgba(0, 0, 0, 0.5), 0 1px 2px 0 rgba(0, 0, 0, 0.6)",shadow2:"0 6px 10px 0 rgba(0, 0, 0, 0.3), 0 2px 2px 0 rgba(0, 0, 0, 0.2)"};t.extend(n.prototype,{init:function(){this.$list=t(this.element),this.tiles=this.$list[0].getElementsByClassName("tile"),this.settings.startSize=this.settings.colSize,this.settings.singleWidth=3*this.settings.colSize;var e=this.settings.startWidth;switch(this.settings.mode){case"mixed":this.fixedSize=!1,this.oneColumn=!1,this.settings.colSize=this.settings.startSize;break;case"fixed":this.fixedSize=!0,this.oneColumn=!1,this.settings.colSize=this.settings.startSize;break;case"column":console.log("init:",this.settings.mode),this.fixedSize=!1,this.oneColumn=!0,e="100%",this.settings.colSize=this.settings.singleWidth}this.$list.find(".tile").remove(),TweenLite.to(this.$list,.2,{width:"column"===this.settings.mode?"100%":e});var s=this;TweenLite.delayedCall(.25,function(){s.resize();for(var t=0;10>t;t++)s.createTile()}),t(i).on("resize",function(){s.resize()})},resize:function(){this.colCount=this.oneColumn?1:Math.floor(this.$list.outerWidth()/(this.settings.colSize+this.settings.gutter)),this.gutterStep=1===this.colCount?this.settings.gutter:this.settings.gutter*(this.colCount-1)/this.colCount,this.rowCount=0,this.layoutInvalidated()},createTile:function(){function i(){l=this.x,a.isDragging=!0,a.lastIndex=a.index,TweenLite.to(o,.2,{autoAlpha:.75,boxShadow:h.settings.shadow2,scale:.95,zIndex:"+=1000"})}function e(){if(!this.hitTest(h.$list,0))return a.inBounds=!1,void h.changePosition(a.index,h.tiles.length-1);a.inBounds=!0;for(var t=0;t<h.tiles.length;t++){var i=h.tiles[t].tile,e=a.row===i.row,s=e?a.row:-1,n=e?this.x<l&&a.index>t:!0,o=e?this.x>l&&a.index<t:!0,r=i.positioned&&(n||o);if(this.hitTest(h.tiles[t],h.settings.threshold)&&r){h.changePosition(a.index,t,s);break}}l=this.x}function s(){this.hitTest(h.$list,0)?h.layoutInvalidated():h.changePosition(a.index,a.lastIndex),TweenLite.to(o,.2,{autoAlpha:1,boxShadow:h.settings.shadow1,scale:1,x:a.x,y:a.y,zIndex:++h.zIndex}),a.isDragging=!1}var n=this.fixedSize||this.oneColumn?1:Math.floor(2*Math.random())+1,o=t('<div class="tile"><i class="fa fa-bolt fa-6"></i></div>'),l=0,h=this;Draggable.create(o,{onDrag:e,onPress:i,onRelease:s,zIndexBoost:!1});var a={col:null,colspan:n,height:0,inBounds:!0,index:null,isDragging:!1,lastIndex:null,newTile:!0,positioned:!1,row:null,rowspan:1,width:0,x:0,y:0};o[0].tile=a,this.$list.append(o),this.layoutInvalidated()},layoutInvalidated:function(i){var e=new TimelineMax,s=i>-1,n=0,o=0,l=0,h=.35,a=this;this.$list.find(".tile").each(function(n,r){var d=this.tile,g=d.row,u=d.col,c=d.newTile;if(!s||(l=d.row,d.row===i)){if(o+d.colspan>a.colCount&&(o=0,l++),t.extend(d,{col:o,row:l,index:n,x:o*a.gutterStep+o*a.settings.colSize,y:l*a.gutterStep+l*a.settings.rowSize,width:d.colspan*a.settings.colSize+(d.colspan-1)*a.gutterStep,height:d.rowspan*a.settings.rowSize}),"column"===a.settings.mode&&(d.width="100%"),o+=d.colspan,d.isDragging&&d.inBounds&&(d.lastIndex=n),c){d.newTile=!1;var x={autoAlpha:0,boxShadow:a.settings.shadow1,height:d.height,scale:0,width:d.width},w={autoAlpha:1,scale:1,zIndex:a.zIndex};e.fromTo(r,h,x,w,"reflow")}if(!d.isDragging&&(g!==d.row||u!==d.col)){var f=c?0:h;g!==d.row&&e.set(r,{zIndex:++a.zIndex},"reflow"),e.to(r,f,{x:d.x,y:d.y,onComplete:function(){d.positioned=!0},onStart:function(){d.positioned=!1}},"reflow")}}}),l!==a.rowCount&&(a.rowCount=l,n=a.rowCount*a.gutterStep+ ++l*a.settings.rowSize,e.to(a.$list,.2,{height:n},"reflow"))},changePosition:function(t,i,e){var s=this.$list.find(".tile"),n=t>i?"insertBefore":"insertAfter";s.eq(t)[n](s.eq(i)),this.layoutInvalidated(e)}}),t.fn[o]=function(i){return this.each(function(){t.data(this,"plugin_"+o)||t.data(this,"plugin_"+o,new n(this,i))})}}(jQuery,window,document);